function [X,S]=rand(h,nSamples)%[X,S]=rand(h,nSamples);generates a random sequence of data%from a given Hidden Markov Model.%%Input:%h=         HMM object%nSamples=  maximum no of output samples (scalars or column vectors)%%Result:%X= matrix or row vector with output data samples%S= row vector with corresponding integer state values%   obtained from the h.StateGen component.%   nS= length(S) == size(X,2)= number of output samples.%   If the StateGen can generate infinite-duration sequences,%       nS == nSamples%   If the StateGen is a finite-duration MarkovChain,%       nS <= nSamples%%----------------------------------------------------%Code Authors:% Alfredo Fanghella (ajfv@kth.se)% Hirahi Galindo (hirahi@kth.se)%----------------------------------------------------if numel(h)>1    error('Method works only for a single object');end;%h: HMM object.%h.StateGen is the MarkovChain%h.OutputDistr could be DiscreteD, GaussD,etc%DataSize is a class method: length of vectors in the output sequence% Random vector of statesS = h.StateGen.rand(nSamples);nS= length(S);%The random sequence should have these dimensionsX = zeros(h.DataSize, nS);%Each column of X should be generated taking into account%the prob. distribution of each statefor i = 1:nS     X(:, i) = h.OutputDistr(S(i)).rand(1);endend